{
  "_meta": {
    "saved_at": "2026-01-27T03:38:53.415916",
    "source": "perplexity-mcp",
    "model": "sonar-pro",
    "query": "Claude Code CLI settings.json CLAUDE.md rules agents hidden features undocumented",
    "query_length": 81,
    "checksum": "sha256:2357b3e9f990141fbfa8841a30c70a689e3413687a697328d9443f646c484afb"
  },
  "response": {
    "id": "ae54085b-1080-44c6-8809-1ed521982ceb",
    "model": "sonar-pro",
    "created": 1769495933,
    "usage": {
      "prompt_tokens": 15,
      "completion_tokens": 954,
      "total_tokens": 969,
      "search_context_size": "low",
      "cost": {
        "input_tokens_cost": 0.0,
        "output_tokens_cost": 0.014,
        "request_cost": 0.006,
        "total_cost": 0.02
      }
    },
    "citations": [
      "https://docs.z.ai/scenario-example/develop-tools/claude",
      "https://shipyard.build/blog/claude-code-cheat-sheet/",
      "https://www.eesel.ai/blog/settings-json-claude-code",
      "https://tessl.io/blog/configuring-claude-code",
      "https://code.claude.com/docs/en/settings",
      "https://github.com/feiskyer/claude-code-settings",
      "https://www.builder.io/blog/claude-code",
      "https://scottspence.com/posts/configuring-mcp-tools-in-claude-code"
    ],
    "search_results": [
      {
        "title": "Claude Code - Overview - Z.AI DEVELOPER DOCUMENT",
        "url": "https://docs.z.ai/scenario-example/develop-tools/claude",
        "date": "2025-12-22",
        "last_updated": "2026-01-01",
        "snippet": "If adjustments are needed, you can directly modify the configuration file (for example, ~/.claude/settings.json in Claude Code) to switch to other models. It is ...",
        "source": "web"
      },
      {
        "title": "Claude Code CLI Cheatsheet: config, commands, prompts, + best ...",
        "url": "https://shipyard.build/blog/claude-code-cheat-sheet/",
        "date": "2026-01-20",
        "last_updated": "2026-01-27",
        "snippet": "Claude Code uses hierarchical settings stored in JSON files: User settings: ~/.claude/settings.json (applies to all projects); Project settings: ...",
        "source": "web"
      },
      {
        "title": "A developer's guide to settings.json in Claude Code (2025) - eesel AI",
        "url": "https://www.eesel.ai/blog/settings-json-claude-code",
        "date": "2025-10-14",
        "last_updated": "2026-01-26",
        "snippet": "The settings.json Claude Code configuration involves a confusing hierarchy of files, including a legacy file, global user settings, project- ...",
        "source": "web"
      },
      {
        "title": "Configuring Claude Code - Tessl",
        "url": "https://tessl.io/blog/configuring-claude-code",
        "date": "2025-06-19",
        "last_updated": "2026-01-27",
        "snippet": "The CLI has a simple claude config command, which manages things into ~/.claude/claude.json . I found it to be a bit buggy at times and it seems ...",
        "source": "web"
      },
      {
        "title": "Claude Code settings - Claude Code Docs",
        "url": "https://code.claude.com/docs/en/settings",
        "date": "2026-01-26",
        "last_updated": "2026-01-26",
        "snippet": "The settings.json file is our official mechanism for configuring Claude Code through hierarchical settings: ... Other configuration is stored in ~/.claude.json .",
        "source": "web"
      },
      {
        "title": "Claude Code settings, commands and agents for vibe coding - GitHub",
        "url": "https://github.com/feiskyer/claude-code-settings",
        "date": "2026-01-24",
        "last_updated": "2026-01-06",
        "snippet": "A curated collection of Claude Code settings, custom commands, skills and sub-agents designed for enhanced development workflows.",
        "source": "web"
      },
      {
        "title": "How I use Claude Code (+ my best tips) - Builder.io",
        "url": "https://www.builder.io/blog/claude-code",
        "date": "2025-07-11",
        "last_updated": "2026-01-26",
        "snippet": "... claude/settings.json file in your project directory, configured like this: { \"hooks\": [ { \"matcher\": \"Edit|Write\", \"hooks\": [ { \"type\": \"command ...",
        "source": "web"
      },
      {
        "title": "Configuring MCP Tools in Claude Code - The Better Way",
        "url": "https://scottspence.com/posts/configuring-mcp-tools-in-claude-code",
        "date": "2025-03-29",
        "last_updated": "2025-07-25",
        "snippet": "Claude Code's default approach for configuring MCP tools is through a CLI wizard ( claude mcp add ). You run a command, and it walks you through setting up ...",
        "source": "web"
      }
    ],
    "object": "chat.completion",
    "choices": [
      {
        "index": 0,
        "message": {
          "role": "assistant",
          "content": "Claude Code CLI uses a hierarchical **settings.json** configuration system across multiple files for customizing models, permissions, hooks, environment variables, and tools, with precedence from local project overrides down to global user settings.\n\n### Settings Hierarchy and Locations\nSettings merge with higher-precedence files overriding lower ones[2][3][5]:\n- **Managed settings** (`managed-settings.json`): Highest precedence, IT/DevOps-enforced, non-overridable (e.g., blocked sources)[5].\n- **Command-line arguments**: Temporary session overrides[5].\n- **Local project** (`.claude/settings.local.json`): Personal, git-ignored overrides[2][3][5].\n- **Shared project** (`.claude/settings.json`): Team-shared, git-committed[2][3][5].\n- **User/global** (`~/.claude/settings.json`): Applies to all projects[1][2][5].\n\nLegacy or separate configs like `~/.claude/claude.json` or `~/.claude.json` exist but are buggy or deprecated; use `settings.json` primarily[4][5].\n\n**Example user/project settings.json** structure[1][2][5]:\n```\n{\n  \"model\": \"claude-sonnet-4-20250514\",\n  \"maxTokens\": 4096,\n  \"env\": {\n    \"ANTHROPIC_AUTH_TOKEN\": \"your_key\",\n    \"ANTHROPIC_BASE_URL\": \"https://api.z.ai/api/anthropic\",\n    \"API_TIMEOUT_MS\": \"3000000\"\n  },\n  \"permissions\": {\n    \"allowedTools\": [\"Read\", \"Write\", \"Bash(git *)\"],\n    \"deny\": [\"Read(./.env)\", \"Read(./.env.*)\"]\n  },\n  \"hooks\": {\n    \"PostToolUse\": [{\n      \"matcher\": \"Write(*.py)\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"python -m black $file\"\n      }]\n    }],\n    \"SessionStart\": [{\n      \"matcher\": \"startup\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"echo 'conda activate myenv' >> \\\"$CLAUDE_ENV_FILE\\\"\"\n      }]\n    }]\n  },\n  \"enabledPlugins\": {\n    \"code-formatter@team-tools\": true\n  }\n}\n```\n\n### CLAUDE.md Rules\n**CLAUDE.md** files provide memory/context loaded at startup, with hierarchy[5]:\n- Global: `~/.claude/CLAUDE.md`\n- Project: `CLAUDE.md` or `.claude/CLAUDE.md`\n- Local: `CLAUDE.local.md`\n\nUsed for instructions, rules, or custom prompts (e.g., vibe coding workflows)[6].\n\n### Agents (Subagents)\nCustom subagents stored hierarchically[5][6]:\n- User: `~/.claude/agents/`\n- Project: `.claude/agents/`\n\nCurated examples available for development workflows[6].\n\n### Hidden/Undocumented Features\n- **Hooks**: Trigger commands on events (e.g., PostToolUse for auto-formatting, SessionStart for env setup); project-specific via `$CLAUDE_ENV_FILE`[2][5][7].\n- **Permissions granularity**: Allow/deny specific tools like `Bash(npm run:*)`; deny rules sometimes ignored (security risk)[2][3][5].\n- **MCP servers**: Extend tools/integrations; configured via `~/.claude.json`, `.mcp.json`, or CLI (`claude mcp add`); per-project overrides[5][8].\n- **Skills**: Custom prompts invoked via `/skill-name` or auto-loaded[5].\n- **CLI flags**: `--output-format json`, `--input-format stream-json`, `--verbose` for logging[2].\n- **Custom tools**: Bash scripts for file search (e.g., repo indexing via JSON stdin/stdout)[5].\n- **Marketplaces**: Define plugin sources in managed settings (exact matching, non-overridable)[5].\n\n### Troubleshooting and Best Practices\n- Validate JSON format; restart CLI (`claude`) after edits; delete/recreate if needed[1].\n- Review changes before accepting; deny access to `.env`; use local files for secrets[2].\n- Permissions project settings override user ones[5].\n- Environment vars settable in settings.json or hooks for team rollout[5].\n\nFor full examples, see curated GitHub repos[6]. Deny rules unreliability noted as a common issue[3]."
        },
        "delta": {
          "role": "assistant",
          "content": ""
        },
        "finish_reason": "stop"
      }
    ]
  }
}