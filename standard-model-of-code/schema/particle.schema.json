{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://standardmodelofcode.org/schemas/particle.json",
  "title": "Standard Model of Code - Particle",
  "description": "A single classified code entity with 10-dimensional semantic coordinates",
  "type": "object",
  "required": [
    "id",
    "atom",
    "dimensions",
    "level",
    "plane",
    "location"
  ],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique particle ID: file_path::qualified_name",
      "pattern": "^.+::[a-zA-Z_][a-zA-Z0-9_.]*$",
      "examples": [
        "src/auth/user.py::UserService.get_by_id"
      ]
    },
    "atom": {
      "type": "string",
      "description": "Atom type from the 200-atom periodic table (Phase.Family.Name)",
      "examples": [
        "LOG.FNC.Method",
        "ORG.AGG.Class",
        "DAT.VAR.Parameter"
      ]
    },
    "tau": {
      "type": "string",
      "description": "Canonical τ notation encoding all dimensions",
      "pattern": "^τ\\(.+\\)$",
      "examples": [
        "τ(Method:Query:App:IO:SL:R:U:92)"
      ]
    },
    "name": {
      "type": "string",
      "description": "Simple name of the code entity",
      "examples": [
        "get_by_id",
        "UserService",
        "user_id"
      ]
    },
    "qualified_name": {
      "type": "string",
      "description": "Fully qualified name including container hierarchy",
      "examples": [
        "auth.UserService.get_by_id"
      ]
    },
    "dimensions": {
      "$ref": "#/$defs/dimensions",
      "description": "10-dimensional semantic classification (8 core + 2 contextual)"
    },
    "level": {
      "$ref": "#/$defs/level",
      "description": "Holarchy level (L-3 to L12)"
    },
    "plane": {
      "enum": [
        "Physical",
        "Virtual",
        "Semantic"
      ],
      "description": "Popper's world mapping - which plane this classification applies to"
    },
    "location": {
      "$ref": "#/$defs/location",
      "description": "Source code location"
    },
    "metadata": {
      "$ref": "#/$defs/metadata",
      "description": "Additional extracted information"
    },
    "edges_out": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/edge"
      },
      "description": "Outgoing relationships from this particle"
    },
    "metrics": {
      "$ref": "#/$defs/metrics",
      "description": "Complexity, coupling, and cohesion metrics (Shannon-inspired)"
    },
    "ddd": {
      "$ref": "#/$defs/ddd",
      "description": "Domain-Driven Design properties (aggregate roots, bounded contexts)"
    },
    "violations": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/violation"
      },
      "description": "Antimatter law violations detected (Clean Arch + Dijkstra layer rules)"
    }
  },
  "$defs": {
    "dimensions": {
      "type": "object",
      "required": [
        "D1_WHAT"
      ],
      "properties": {
        "D1_WHAT": {
          "type": "string",
          "description": "Atom type - what kind of code entity is this"
        },
        "D2_LAYER": {
          "enum": [
            "Interface",
            "Application",
            "Core",
            "Infrastructure",
            "Test",
            "Unknown"
          ],
          "description": "Clean Architecture layer"
        },
        "D3_ROLE": {
          "$ref": "#/$defs/role",
          "description": "DDD tactical role - what purpose does it serve"
        },
        "D4_BOUNDARY": {
          "enum": [
            "Internal",
            "Input",
            "Output",
            "I-O"
          ],
          "description": "Information flow boundary crossing"
        },
        "D5_STATE": {
          "enum": [
            "Stateful",
            "Stateless"
          ],
          "description": "State management characteristic"
        },
        "D6_EFFECT": {
          "enum": [
            "Pure",
            "Read",
            "Write",
            "ReadWrite"
          ],
          "description": "Side effect classification"
        },
        "D7_LIFECYCLE": {
          "enum": [
            "Create",
            "Use",
            "Destroy"
          ],
          "description": "Object lifecycle phase"
        },
        "D8_TRUST": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Classification confidence percentage"
        },
        "D9_INTENT": {
          "enum": [
            "Documented",
            "Implicit",
            "Ambiguous",
            "Contradictory"
          ],
          "description": "Popper World 2 (Mental) - programmer intent clarity"
        },
        "D10_LANGUAGE": {
          "type": "string",
          "description": "Ranganathan Matter facet - programming language/platform"
        }
      }
    },
    "level": {
      "enum": [
        "L-3",
        "L-2",
        "L-1",
        "L0",
        "L1",
        "L2",
        "L3",
        "L4",
        "L5",
        "L6",
        "L7",
        "L8",
        "L9",
        "L10",
        "L11",
        "L12"
      ],
      "description": "Holarchy level from L-3 (Bit) to L12 (Universe)"
    },
    "role": {
      "enum": [
        "Query",
        "Finder",
        "Loader",
        "Getter",
        "Command",
        "Creator",
        "Mutator",
        "Destroyer",
        "Factory",
        "Builder",
        "Repository",
        "Store",
        "Cache",
        "Service",
        "Controller",
        "Manager",
        "Validator",
        "Guard",
        "Asserter",
        "Transformer",
        "Mapper",
        "Serializer",
        "Handler",
        "Listener",
        "Subscriber",
        "Utility",
        "Formatter",
        "Helper",
        "Internal",
        "Lifecycle",
        "Unknown"
      ],
      "description": "One of 33 semantic roles from DDD tactical patterns"
    },
    "location": {
      "type": "object",
      "required": [
        "file",
        "line_start",
        "line_end"
      ],
      "properties": {
        "file": {
          "type": "string",
          "description": "Relative file path from repository root"
        },
        "line_start": {
          "type": "integer",
          "minimum": 1,
          "description": "Starting line number (1-indexed)"
        },
        "line_end": {
          "type": "integer",
          "minimum": 1,
          "description": "Ending line number (1-indexed)"
        },
        "col_start": {
          "type": "integer",
          "minimum": 0,
          "description": "Starting column (0-indexed)"
        },
        "col_end": {
          "type": "integer",
          "minimum": 0,
          "description": "Ending column (0-indexed)"
        }
      }
    },
    "metadata": {
      "type": "object",
      "properties": {
        "signature": {
          "type": "string",
          "description": "Function/method signature"
        },
        "docstring": {
          "type": "string",
          "description": "Documentation string"
        },
        "decorators": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Applied decorators/annotations"
        },
        "parameters": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Parameter names"
        },
        "return_type": {
          "type": "string",
          "description": "Return type annotation"
        },
        "complexity": {
          "type": "number",
          "description": "Cyclomatic complexity"
        },
        "lines_of_code": {
          "type": "integer",
          "description": "Lines of code count"
        },
        "language": {
          "type": "string",
          "description": "Programming language"
        }
      }
    },
    "edge": {
      "type": "object",
      "required": [
        "target",
        "type",
        "family"
      ],
      "properties": {
        "target": {
          "type": "string",
          "description": "Target particle ID"
        },
        "type": {
          "enum": [
            "calls",
            "imports",
            "uses",
            "references",
            "inherits",
            "implements",
            "extends",
            "mixes_in",
            "contains",
            "is_part_of",
            "returns",
            "receives",
            "precedes",
            "follows",
            "triggers",
            "disposes",
            "delegates_to",
            "decorates",
            "wraps"
          ],
          "description": "Specific edge type"
        },
        "family": {
          "enum": [
            "Structural",
            "Dependency",
            "Inheritance",
            "Semantic",
            "Temporal"
          ],
          "description": "One of 5 edge families"
        },
        "weight": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Edge strength (0-1)"
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Detection confidence"
        },
        "location": {
          "type": "object",
          "properties": {
            "file": {
              "type": "string"
            },
            "line": {
              "type": "integer"
            }
          },
          "description": "Where this relationship is established"
        }
      }
    },
    "metrics": {
      "type": "object",
      "description": "Complexity and coupling metrics inspired by Shannon's Information Theory and Koestler's tension dynamics",
      "properties": {
        "complexity": {
          "type": "object",
          "properties": {
            "cyclomatic": {
              "type": "number",
              "description": "McCabe cyclomatic complexity"
            },
            "cognitive": {
              "type": "number",
              "description": "Cognitive complexity (SonarQube style)"
            },
            "halstead_volume": {
              "type": "number",
              "description": "Halstead volume metric"
            },
            "entropy": {
              "type": "number",
              "description": "Shannon entropy of token distribution"
            }
          }
        },
        "coupling": {
          "type": "object",
          "description": "Koestler-inspired tension between self-assertive and integrative tendencies",
          "properties": {
            "afferent": {
              "type": "integer",
              "description": "Incoming dependencies (Ca)"
            },
            "efferent": {
              "type": "integer",
              "description": "Outgoing dependencies (Ce)"
            },
            "instability": {
              "type": "number",
              "description": "Ce / (Ca + Ce)"
            },
            "tension": {
              "type": "number",
              "description": "Balance between autonomy and integration"
            }
          }
        },
        "cohesion": {
          "type": "object",
          "properties": {
            "lcom": {
              "type": "number",
              "description": "Lack of Cohesion of Methods"
            }
          }
        }
      }
    },
    "ddd": {
      "type": "object",
      "description": "Domain-Driven Design tactical properties (Evans)",
      "properties": {
        "is_aggregate_root": {
          "type": "boolean",
          "description": "Is this the root of a DDD aggregate?"
        },
        "aggregate_id": {
          "type": "string",
          "description": "ID of the aggregate this belongs to"
        },
        "bounded_context": {
          "type": "string",
          "description": "DDD bounded context name"
        },
        "invariants": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Business rules/invariants this entity enforces"
        },
        "domain_events": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Domain events this entity can produce"
        }
      }
    },
    "violation": {
      "type": "object",
      "description": "Antimatter law violation (architectural anti-pattern)",
      "required": [
        "law_id",
        "severity",
        "message"
      ],
      "properties": {
        "law_id": {
          "type": "string",
          "enum": [
            "AM001",
            "AM002",
            "AM003",
            "AM004",
            "AM005"
          ],
          "description": "Antimatter law ID"
        },
        "law_name": {
          "type": "string",
          "enum": [
            "LayerSkipViolation",
            "ReverseLayerDependency",
            "GodClass",
            "AnemicModel",
            "BoundedContextViolation"
          ]
        },
        "severity": {
          "enum": [
            "ERROR",
            "WARNING",
            "INFO"
          ],
          "description": "Violation severity"
        },
        "message": {
          "type": "string",
          "description": "Human-readable explanation"
        },
        "source_theory": {
          "type": "string",
          "description": "Which foundational theory this violates",
          "examples": [
            "Clean Architecture",
            "Dijkstra",
            "Koestler",
            "DDD"
          ]
        }
      }
    }
  }
}