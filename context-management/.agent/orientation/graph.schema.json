{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://standardmodelofcode.org/schemas/graph.json",
    "title": "Standard Model of Code - Graph",
    "description": "Complete codebase represented as classified particles and typed edges",
    "type": "object",
    "required": [
        "version",
        "generated_at",
        "repository",
        "particles"
    ],
    "properties": {
        "version": {
            "type": "string",
            "pattern": "^\\d+\\.\\d+\\.\\d+$",
            "description": "Schema version",
            "examples": [
                "1.0.0"
            ]
        },
        "generated_at": {
            "type": "string",
            "format": "date-time",
            "description": "ISO 8601 timestamp of generation"
        },
        "generator": {
            "type": "object",
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Tool name (e.g., 'Collider')"
                },
                "version": {
                    "type": "string",
                    "description": "Tool version"
                }
            }
        },
        "repository": {
            "type": "object",
            "required": [
                "name",
                "root"
            ],
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Repository name"
                },
                "root": {
                    "type": "string",
                    "description": "Absolute path to repository root"
                },
                "languages": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "description": "Detected programming languages"
                },
                "commit": {
                    "type": "string",
                    "description": "Git commit hash (if available)"
                },
                "branch": {
                    "type": "string",
                    "description": "Git branch name (if available)"
                }
            }
        },
        "statistics": {
            "$ref": "#/$defs/statistics",
            "description": "Aggregate statistics about the analyzed codebase"
        },
        "particles": {
            "type": "array",
            "items": {
                "$ref": "particle.schema.json"
            },
            "description": "All classified code entities"
        }
    },
    "$defs": {
        "statistics": {
            "type": "object",
            "properties": {
                "total_particles": {
                    "type": "integer",
                    "description": "Total number of particles"
                },
                "total_edges": {
                    "type": "integer",
                    "description": "Total number of edges"
                },
                "total_files": {
                    "type": "integer",
                    "description": "Total number of source files"
                },
                "total_lines": {
                    "type": "integer",
                    "description": "Total lines of code"
                },
                "by_level": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "integer"
                    },
                    "description": "Particle count per holarchy level",
                    "examples": [
                        {
                            "L3": 450,
                            "L4": 120,
                            "L5": 35
                        }
                    ]
                },
                "by_layer": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "integer"
                    },
                    "description": "Particle count per architectural layer",
                    "examples": [
                        {
                            "Interface": 50,
                            "Application": 100,
                            "Core": 200,
                            "Infrastructure": 80,
                            "Test": 120
                        }
                    ]
                },
                "by_phase": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "integer"
                    },
                    "description": "Particle count per atom phase",
                    "examples": [
                        {
                            "DATA": 150,
                            "LOGIC": 300,
                            "ORGANIZATION": 100,
                            "EXECUTION": 50
                        }
                    ]
                },
                "by_role": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "integer"
                    },
                    "description": "Particle count per semantic role"
                },
                "by_edge_family": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "integer"
                    },
                    "description": "Edge count per edge family"
                },
                "by_language": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "integer"
                    },
                    "description": "Particle count per programming language"
                },
                "confidence": {
                    "type": "object",
                    "properties": {
                        "mean": {
                            "type": "number"
                        },
                        "median": {
                            "type": "number"
                        },
                        "min": {
                            "type": "number"
                        },
                        "max": {
                            "type": "number"
                        }
                    },
                    "description": "Classification confidence statistics"
                }
            }
        }
    }
}