---
config:
  theme: neo
id: 7b83b196-2f7f-4521-bb71-b2652aa088dc
---
flowchart LR
    T1["Notion Trigger<br>Tasks"] --> GP["Notion - Get Page<br>Source Item"]
    T2["Notion Trigger<br>Events"] --> GP
    T3["Notion Trigger<br>Runs"] --> GP
    T4["Notion Trigger<br>TimeView"] --> GP
    GP --> SET1["Set - Extract Item Properties"]
    WB["Webhook<br>/database-sync"] --> A1["Agent AI - Interpret & Transform"]
    SET1 --> A1
    A1 --> IF_SRC["IF - Check Trigger Source"]
    IF_SRC --> IF_UPD["IF - Update vs Create"]
    IF_UPD -- Create --> N_CREATE["Notion - Create Page<br>New in Destination"]
    IF_UPD -- Update --> N_UPDATE["Notion - Update Page<br>Update&nbsp;Mirror"]
    N_CREATE --> SET_XREF["Set - Add Cross‑Reference ID"]
    N_UPDATE --> SET_TAG["Set - Tag as Synced by Agent"]
    SET_XREF --> IF_LOOP["IF - Loop Protection"]
    SET_TAG --> IF_LOOP
    IF_LOOP --> IF_INACT["IF - Is Item Inactive"]
    IF_INACT --> IF_DEL["IF - Should Delete Mirror"]
    IF_DEL --> N_DELETE["Notion - Delete Page<br>Remove Mirror"]
    LM["OpenAI Chat Model"] -- ai_languageModel --> AGENT["AI Agent"]
    TOOL_SRCH["NotionTool - Search<br>Find Mirror"] -- ai_tool --> AGENT
    TOOL_GET["NotionTool - Get Page"] -- ai_tool --> AGENT
    TOOL_CREATE["NotionTool - Create Page"] -- ai_tool --> AGENT
    TOOL_UPDATE["NotionTool - Update Page"] -- ai_tool --> AGENT
    TOOL_DELETE["NotionTool - Delete Page"] -- ai_tool --> AGENT